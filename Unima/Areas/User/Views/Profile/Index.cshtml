@using Unima.Areas.User.Models.ViewModels
@addTagHelper *, Microsoft.AspNetCore.Mvc.TagHelpers

@model ProfileViewModel
@{
    Layout = "/Areas/User/Views/Shared/_Layout.cshtml";
}

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unima</title>

    <style>
        * {
            font-family: vazirmatn;
        }

        .form-select.rtl-left-arrow {
            direction: rtl;
            padding-left: 2.5rem;
            padding-right: 0.2rem;
            background-position: left 0.4rem center;
            background-repeat: no-repeat;
            background-size: 16px 12px;
        }

        .form-select.underline-style {
            border: none;
            border-bottom: 1px solid #6c757d !important;
            border-radius: 0;
        }

            .form-select.underline-style:focus {
                box-shadow: none !important;
                outline: none !important;
                border-bottom: 1px solid black;
            }

        .bootstrap-select .dropdown-item {
            border-radius: 0 !important;
        }



        .Section-title::after {
            width: 15%;
            content: "";
            height: .1rem;
            background-color: #dda853;
            display: inline-block;
        }

        .btn-danger {
            background-color: #dda853;
            color: black;
            border: none;
        }

            .btn-danger:hover {
                background-color: #dda853b8;
                color: rgba(0, 0, 0, 0.797);
            }

        .Section-Card {
            box-shadow: rgba(50, 50, 93, 0.25) 0px 2px 5px -1px, rgba(0, 0, 0, 0.3) 0px 1px 3px -1px;
        }

        .btn-veri {
            width: 30%;
            height: 20%;
        }

        .Section-Personal {
            display: flex;
            flex-direction: column;
        }

        .bg-secondary {
            background-color: #9D9D9F !important;
        }

        .w-46 {
            width: 46% !important;
        }

        .fs-6 {
            font-size: 16px !important;
        }
    </style>
</head>

<body>
    <section class="Setting align-items-center">
        <div class="Section-Personal row ">
            <div class="col-xl-12 pb-2 mb-4 mt-5 Section-title justify-content-center align-item-center">
                <p class="m-0 fs-5">
                    اطلاعات شخصی
                </p>
            </div>

            <div class="Section-Card p-5 mb-5 bg-white rounded col-xl-11 d-flex justify-content-center flex-wrap m-auto">
                <div class="border-bottom border-secondary col-xl-5 m-4">
                    <label asp-for="@Model.ProfileModel.FullName" class="fs-5 d-inline-block text-secondary mb-2"></label>
                    <div class="w-100 d-flex justify-content-between align-items-center" dir="rtl">
                        <div>
                            <span class="fs-6">@Model.ProfileModel.FullName</span>
                        </div>
                        <div class="Card-icon ms-1">
                            <a href="#" data-bs-toggle="modal" data-bs-target="#editname">
                                <i class="fa-solid fa-pen-to-square fs-6 text-black"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="border-bottom border-secondary col-xl-5 m-4">
                    <label asp-for="@Model.ProfileModel.Email" class="fs-5 d-inline-block text-secondary mb-2"></label>
                    <div class="w-100 d-flex justify-content-between align-items-center" dir="rtl">
                        <div>
                            <span class="fs-6">@Model.ProfileModel.Email</span>
                        </div>
                        <div class="Card-icon ms-1">
                            <a href="#" data-bs-toggle="modal" data-bs-target="#editemail">
                                <i class="fa-solid fa-pen-to-square fs-6 text-black"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="border-bottom border-secondary col-xl-5 m-4">
                    <label asp-for="@Model.ProfileModel.PhoneNumber" class="fs-5 d-inline-block text-secondary mb-2"></label>
                    <div class="w-100 d-flex justify-content-between align-items-center" dir="rtl">
                        <div>
                            <span class="fs-6">@Model.ProfileModel.PhoneNumber</span>
                        </div>
                        <div class="Card-icon ms-1">
                            <a href="#" data-bs-toggle="modal" data-bs-target="#editphone">
                                <i class="fa-solid fa-pen-to-square fs-6 text-black"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="border-bottom border-secondary col-xl-5 col-lg-10 m-4">
                    <label asp-for="@Model.ProfileModel.Username" class="fs-5 d-inline-block text-secondary mb-2"></label>
                    <div class="w-100 d-flex justify-content-between align-items-center" dir="rtl">
                        <div>
                            <span class="fs-6">@Model.ProfileModel.Username</span>
                        </div>
                        <div class="Card-icon ms-1">
                            <a href="#" data-bs-toggle="modal" data-bs-target="#editcode">
                                <i class="fa-solid fa-pen-to-square fs-6 text-black"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="border-bottom border-secondary col-xl-5 m-4">
                    <label for="name" class=" fs-5 d-inline-block text-secondary mb-2">رمز عبور</label>
                    <div class="w-100 d-flex justify-content-between align-items-center" dir="rtl">
                        <div>
                            <span class="fs-6">*********</span>
                        </div>
                        <div class="Card-icon ms-1">
                            <a href="#" data-bs-toggle="modal" data-bs-target="#editpass">
                                <i class="fa-solid fa-pen-to-square fs-6 text-black"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="border-bottom border-secondary col-xl-5 m-4">
                    <label asp-for="@Model.ProfileModel.SelfServicePassword" class=" fs-5 d-inline-block text-secondary mb-2"></label>
                    <div class="w-100 d-flex justify-content-between align-items-center" dir="rtl">
                        <div>
                            <span class="fs-6">b1234567</span>
                        </div>
                        <div class="Card-icon ms-1">
                            <a href="#" data-bs-toggle="modal" data-bs-target="#editcode">
                                <i class="fa-solid fa-pen-to-square fs-6 text-black"></i>
                            </a>
                        </div>
                    </div>
                </div>
                <div class="col-xl-5 m-4" dir="rtl">
                    <label asp-for="@Model.ProfileModel.Gender" class="form-label fs-5 d-inline-block text-secondary mb-2"></label>
                    <select id="gender" class="form-select rtl-left-arrow underline-style" aria-label="Default select example" onchange="getSelfLocationData()">
                        <option value="-1" selected>انتخاب کنید</option>
                    </select>
                </div>
                <div class="col-xl-5 m-4">
                    <label asp-for="@Model.ProfileModel.SelfServiceLocation" class="form-label fs-5 d-inline-block text-secondary mb-2"></label>
                    <select id="selfLocations" class="form-select rtl-left-arrow underline-style" aria-label="Default select example">
                        <option value="-1" selected>انتخاب کنید</option>
                    </select>
                </div>
            </div>
        </div>

        @* MODALS *@
        <div class="modal fade" id="a" tabindex="-1" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered flex-wrap">
                <div class="modal-content Section-Card">
                    <div class="modal-header">
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="close-tab"></button>
                    </div>
                    <div class="modal-body d-flex justify-content-between bg-light">
                        <form>
                            <div class="mb-3">
                                <label for="name" class="form-label">نام</label>
                                <input type="text" class="form-control" id="name">
                            </div>
                            <div class="mb-3"></div>
                            <label for="family" class="form-label">نام‌خانوادگی</label>
                            <input type="text" class="form-control" id="family">
                        </form>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">بستن</button>
                    <button type="button" class="btn btn-primary">ذخیره</button>
                </div>
            </div>
        </div>
        <div class="modal fade" id="editname" tabindex="-1" aria-labelledby="exampleModalCenterTitle"
             aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content bg-light">
                    <div class="modal-header">
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="close-tab"></button>
                    </div>
                    <div class="modal-body d-flex flex-column m-2 fs-7">
                        <p>
                            لطفا اطلاعات شناسایی خود را وارد کنید. <br> نام‌ونام‌خانوادگی شما باید با اطلاعات سامانه
                            پویا
                            همخوانی داشته باشد.
                        </p>
                        <div class="d-flex flex-nowrap justify-content-between">
                            <div class="m-2 w-50">
                                <label for="name" class="fs-6 mb-2">نام</label>
                                <input type="text"
                                       class="form-control bg-light w-100 border border-1 border-dark-subtle" id="name">
                            </div>
                            <div class="m-2 w-50">
                                <label for="family" class="mb-2 fs-6">نام‌خانوادگی</label>
                                <input type="text"
                                       class="form-control bg-light w-100 border border-1 border-dark-subtle" id="family">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger">ذخیره</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="editemail" tabindex="-1" aria-labelledby="exampleModalCenterTitle"
             aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered ">
                <div class="modal-content bg-light" style="z-index: 30;">
                    <div class="modal-header">
                        <button type="button" class="btn-close " data-bs-dismiss="modal"
                                aria-label="close-tab"></button>
                    </div>
                    <div class="modal-body">
                        <form>
                            <label for="email" class="form-label fs-6">ایمیل خود را وارد کنید.</label>
                            <div class="mb-3 d-flex align-items-center w-75">
                                <input type="email" class="form-control bg-light border border-1 border-dark-subtle"
                                       id="email" dir="ltr">
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">بستن</button>
                        <button type="button" class="btn btn-danger">ذخیره</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="editphone" tabindex="-1" aria-labelledby="exampleModalCenterTitle"
             aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered ">
                <div class="modal-content bg-light" style="width: 85% !important;">
                    <div class="modal-header">
                        <button type="button" class="btn-close " data-bs-dismiss="modal"
                                aria-label="close-tab"></button>
                    </div>
                    <div class="modal-body">
                        <form class="m-2">
                            <label for="phone" class="form-label fs-6">شماره همراه</label>
                            <div class="mb-3 d-flex align-items-center">
                                <div class="input-group mb-3 w-75">
                                    <div class="input-group">
                                        <input type="text"
                                               class="form-control rounded rounded-end-1 rounded-0 border border-1 border-dark-subtle"
                                               aria-label="" aria-describedby="basic-addon1" type="numric">
                                        <button class="btn btn-danger rounded rounded-start-1 rounded-0"
                                                type="button">
                                            تایید
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <label for="code" class="form-label fs-6">کد تاییدیه</label>
                            <div class="input-group mb-3 w-75">
                                <div class="input-group w-75">
                                    <input type="text" inputmode="numeric"
                                           class="form-control bg-light rounded rounded-0 rounded-end-1 border border-1 border-dark-subtle">
                                    <button class="btn btn-danger rounded rounded-start-1 rounded-0 " type="button"
                                            aria-hidden="false">
                                        ارسال کد
                                    </button>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger">ذخیره</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="editcode" tabindex="-1" aria-labelledby="exampleModalCenterTitle"
             aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content bg-light">
                    <div class="modal-header">
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="close-tab"></button>
                    </div>
                    <div class="modal-body d-flex flex-column m-2 fs-7">
                        <p class="m-2">
                            لطفا اطلاعات خواسته شده را دقیق وارد کنید. <br>
                            سامانه یونیما هیچ مسئولیتی در قبال اطلاعات نادرست نمیپذیرد.
                        </p>
                        <div class="d-flex flex-nowrap justify-content-between">
                            <div class="m-2 w-50">
                                <label for="name" class="fs-6 mb-2">شماره‌دانشجویی</label>
                                <input type="text"
                                       class="form-control bg-light w-100 border border-1 border-dark-subtle" id="name">
                            </div>
                            <div class="m-2 w-50">
                                <label for="family" class="mb-2 fs-6">رمز سلف دانشجویی</label>
                                <input type="text"
                                       class="form-control bg-light w-100 border border-1 border-dark-subtle" id="family">
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger">ذخیره</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="editpass" tabindex="-1" aria-labelledby="exampleModalCenterTitle"
             aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered ">
                <div class="modal-content bg-light" style="width: 85% !important;">
                    <div class="modal-header">
                        <button type="button" class="btn-close " data-bs-dismiss="modal"
                                aria-label="close-tab"></button>
                    </div>
                    <div class="modal-body">
                        <form class="m-2">
                            <label for="passcurrent" class="form-label fs-6">رمزعبور فعلی</label>
                            <div class="mb-3 d-flex align-items-center">
                                <div class="input-group mb-2 w-50">
                                    <div class="input-group">
                                        <input type="text"
                                               class="form-control border border-1 border-dark-subtle"
                                               aria-label="" aria-describedby="basic-addon1" type="numric" id="passcurrent">
                                    </div>
                                </div>
                            </div>
                            <label for="passcurrent" class="form-label fs-6">رمزعبور جدید</label>
                            <div class="mb-3 d-flex align-items-center">
                                <div class="input-group mb-2 w-50">
                                    <div class="input-group">
                                        <input type="text"
                                               class="form-control border border-1 border-dark-subtle"
                                               aria-label="" aria-describedby="basic-addon1" type="numric" id="passcurrent">
                                    </div>
                                </div>
                            </div>
                            <label for="passcurrent" class="form-label fs-6">تکرار رمزعبور</label>
                            <div class="mb-3 d-flex align-items-center">
                                <div class="input-group mb-2 w-50">
                                    <div class="input-group">
                                        <input type="text"
                                               class="form-control border border-1 border-dark-subtle"
                                               aria-label="" aria-describedby="basic-addon1" type="numric" id="passcurrent">
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger">ذخیره</button>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <script>

        function getGenderData(){
            const gender = document.getElementById('gender')?.value || '';

            fetch(`/User/Profile/GetGenderData`)
            .then(res => res.json())
            .then(data => {
                const select = document.getElementById('gender');

                select.innerHTML = '';
                data.gender.forEach(item => {
                    const option = document.createElement('option');
                    option.value = item.value;
                    option.text = item.text;
                    select.appendChild(option);
                });
                getSelfLocationData();
            });
        }
        window.addEventListener('DOMContentLoaded', getGenderData);

    </script>

</body>
</html>
<script>

    function getSelfLocationData(){
            const gender = document.getElementById('gender')?.value || '';

            fetch(`/User/Profile/GetSelfLocationsData?genderId=${gender}`)
            .then(res => res.json())
            .then(data => {
                populateSelectsFromBackendData(data);
            })
            .catch(err => {
                console.error('Error loading data:', err);
            });
    }

    function populateSelectsFromBackendData(data) {
        Object.entries(data).forEach(([key, items]) => {
            const select = document.getElementById(key);
            if (!select || !Array.isArray(items)) return;

            select.innerHTML = '';
            items.forEach(item => {
                const option = document.createElement('option');
                option.value = item.value;
                option.text = item.text;
                select.appendChild(option);
            });
        });
    }
</script>